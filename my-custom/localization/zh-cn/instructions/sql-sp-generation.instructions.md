---
applyTo: "sql-sp-generation.instructions.md"
---

<!-- 本文件为自动翻译，供参考。请结合实际需求进行校对和完善。-->

# SQL 语句与存储过程生成规范

## 1. 基本原则

- **所有 SQL 必须参数化，禁止拼接字符串**。
- **表、字段、参数命名语义化，遵循数据库命名规范**。
- **存储过程应有输入输出参数说明和用途注释**。
- **复杂逻辑建议拆分为多个存储过程或函数**。

## 2. 语句规范

- **SELECT 只查必要字段，禁止 SELECT \*。**
- **WHERE 条件必须明确，避免全表扫描。**
- **JOIN 明确指定关联条件，避免隐式连接。**
- **分页、排序、聚合等用数据库原生语法实现。**
- **用事务包裹批量操作，保证原子性。**

## 3. 存储过程规范

- **输入参数用 IN，输出用 OUT，必要时用 INOUT。**
- **参数类型与表字段类型一致。**
- **异常处理用 TRY...CATCH 或等效机制。**
- **返回值用标准格式，建议统一用状态码和消息。**
- **存储过程内可调用函数/过程，避免重复代码。**

## 4. 性能与安全

- **关键字段加索引，定期优化执行计划。**
- **避免大事务和长时间锁表。**
- **敏感数据加密存储，访问需权限控制。**
- **定期用 EXPLAIN 分析慢 SQL。**

## 5. 质量检查清单

- [ ] SQL 全部参数化
- [ ] 命名规范统一
- [ ] 存储过程有注释和参数说明
- [ ] 只查必要字段
- [ ] WHERE 条件明确
- [ ] JOIN 条件完整
- [ ] 事务和异常处理健全
- [ ] 性能和安全达标

---

免责声明：本翻译仅供参考，具体实践请结合实际项目需求和最新官方文档。
