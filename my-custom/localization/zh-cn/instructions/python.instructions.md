---
applyTo: "python.instructions.md"
---

<!-- 本文件为自动翻译，供参考。请结合实际需求进行校对和完善。-->

# Python 编码规范与最佳实践

## 1. 代码结构与组织

- **每个模块单独一个文件**，命名用小写字母和下划线。
- **包结构清晰**，每层目录有 `__init__.py`。
- **主程序入口用 `if __name__ == "__main__":`**。
- **配置、常量、业务逻辑分离**。

## 2. 代码风格

- **遵循 PEP8 规范**，统一缩进、空格、换行。
- **变量、函数、类命名语义化**，避免缩写和拼音。
- **类名用驼峰，函数/变量用小写加下划线**。
- **注释解释复杂逻辑或特殊约定**。

## 3. 类型与注解

- **优先使用类型注解**，提升可读性和工具支持。
- **用 `mypy` 静态检查类型**。
- **避免动态类型滥用**。

## 4. 错误处理

- **用 `try/except/finally` 捕获异常**，输出有用错误信息。
- **只捕获需要的异常类型**，避免裸 `except`。
- **自定义异常需继承自 `Exception`**。

## 5. 测试与质量

- **用 pytest 编写单元测试，覆盖主要逻辑分支**。
- **测试文件命名为 `test_*.py`，与被测模块同级或 `tests/` 目录**。
- **集成到 CI/CD 流程，自动化测试和部署**。
- **用 flake8/pylint 静态分析代码质量**。

## 6. 性能与安全

- **避免循环嵌套和 O(n²) 算法**。
- **敏感信息不得硬编码**，用环境变量或配置管理。
- **输入输出需校验和消毒**，防止注入攻击。
- **依赖包定期安全扫描**。

## 7. 依赖与环境

- **用 requirements.txt 或 pyproject.toml 管理依赖**。
- **优先用虚拟环境（venv/conda）隔离项目**。
- **依赖锁定版本，避免构建不一致**。

## 8. 质量检查清单

- [ ] 结构清晰，命名规范
- [ ] 类型注解齐全
- [ ] 错误处理健全
- [ ] 测试覆盖率达标
- [ ] 静态分析无严重警告
- [ ] 性能与安全达标
- [ ] 依赖管理规范

---

免责声明：本翻译仅供参考，具体实践请结合实际项目需求和最新官方文档。
