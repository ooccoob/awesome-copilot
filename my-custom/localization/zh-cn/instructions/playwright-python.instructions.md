---
applyTo: "playwright-python.instructions.md"
---

<!-- 本文件为自动翻译，供参考。请结合实际需求进行校对和完善。-->

# Playwright Python 测试编写指南

## 代码质量标准

- **定位器**：优先使用用户可见、基于角色的定位器（如 `get_by_role`、`get_by_label`、`get_by_text` 等），提升测试的健壮性和可访问性。
- **断言**：使用 Playwright 的自动重试断言（如 `expect(locator).to_have_text()`）。除非专门测试可见性变化，否则避免使用 `expect(locator).is_visible()`。
- **超时**：依赖 Playwright 内置的自动等待机制，避免硬编码等待或增加默认超时。
- **清晰性**：测试和步骤标题应描述意图。仅对复杂逻辑或非显而易见的交互添加注释。

## 测试结构

- **导入**：统一使用 `from playwright.sync_api import Page, expect`。
- **组织**：相关测试用 `describe` 分组。
- **钩子**：用 `before_each` 做通用前置操作（如页面跳转）。
- **命名**：测试和步骤命名清晰，表达具体场景。

## 文件组织

- **位置**：所有测试文件放在 `tests/` 目录。
- **命名**：采用 `<feature-or-page>_spec.py`（如 `login_spec.py`）。
- **范围**：每个主要功能或页面一个测试文件。

## 断言最佳实践

- **结构**：用 `to_have_aria_snapshot` 验证组件可访问性树。
- **元素数量**：用 `to_have_count` 断言元素数量。
- **文本内容**：用 `to_have_text` 精确匹配，用 `to_contain_text` 部分匹配。
- **导航**：用 `to_have_url` 验证跳转。

## 测试执行策略

1. **初次运行**：用 `pytest` 执行全部测试。
2. **调试失败**：分析失败原因并修正。
3. **迭代**：优化定位器、断言或逻辑。
4. **验证**：确保测试稳定通过。
5. **报告**：输出测试结果和发现的问题。

## 质量检查清单

- [ ] 定位器可访问且具体
- [ ] 测试分组合理、结构清晰
- [ ] 断言有意义且符合用户预期
- [ ] 命名规范统一
- [ ] 代码格式规范，注释适当

---

免责声明：本翻译仅供参考，具体实践请结合实际项目需求和最新官方文档。
