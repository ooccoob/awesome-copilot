---
applyTo: "ruby-on-rails.instructions.md"
---

<!-- 本文件为自动翻译，供参考。请结合实际需求进行校对和完善。-->

# Ruby on Rails 编码规范与最佳实践

## 1. 结构与组织

- **遵循 Rails 约定优于配置原则**。
- **每个模型、控制器、视图单独一个文件**。
- **业务逻辑优先放在模型和服务对象中**。
- **避免在控制器和视图中写复杂逻辑**。

## 2. 命名与风格

- **类名用 PascalCase，文件名用 snake_case**。
- **变量、方法命名语义化，避免缩写和拼音**。
- **遵循社区主流风格指南（如 RuboCop）**。
- **注释解释复杂逻辑或特殊约定**。

## 3. 数据库与模型

- **用迁移（migration）管理数据库结构**。
- **模型验证（validates）保证数据完整性**。
- **避免 N+1 查询，合理用 includes/preload**。
- **关联关系用 has_many、belongs_to 等声明**。

## 4. 控制器与路由

- **控制器保持瘦（thin），业务逻辑下沉到模型/服务**。
- **路由用 resources 声明 RESTful 路径**。
- **参数校验用 strong parameters**。

## 5. 视图与前端

- **视图模板用 ERB/Haml，避免内联 JS/CSS**。
- **复用视图用 partials**。
- **表单用 form_with/form_for**。
- **前端交互推荐用 Stimulus、Hotwire 等现代方案**。

## 6. 测试

- **用 RSpec/Minitest 编写单元、集成和系统测试**。
- **测试文件与被测对象同级，命名规范**。
- **测试覆盖率目标 80% 以上**。

## 7. 性能与安全

- **缓存常用查询和页面片段**。
- **避免 SQL 注入，参数用占位符**。
- **敏感信息用环境变量管理**。
- **定期运行 bundle audit 检查依赖安全**。

## 8. 质量检查清单

- [ ] 结构清晰，命名规范
- [ ] 业务逻辑分层合理
- [ ] 数据库和模型设计规范
- [ ] 控制器和路由 RESTful
- [ ] 视图模板规范
- [ ] 测试覆盖率达标
- [ ] 性能与安全合规

---

免责声明：本翻译仅供参考，具体实践请结合实际项目需求和最新官方文档。
