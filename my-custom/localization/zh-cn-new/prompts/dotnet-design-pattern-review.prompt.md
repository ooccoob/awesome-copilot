---
mode: 'agent'
description: '审查C#/.NET代码的设计模式实现并提出改进建议。'
---

# .NET/C#设计模式审查

审查${selection}中的C#/.NET代码的设计模式实现，并为解决方案/项目提出改进建议。不要对代码进行任何更改，只提供审查。

## 必需的设计模式

- **命令模式**：通用基类（`CommandHandler<TOptions>`）、`ICommandHandler<TOptions>`接口、`CommandHandlerOptions`继承、静态`SetupCommand(IHost host)`方法
- **工厂模式**：复杂对象创建服务提供程序集成
- **依赖注入**：主构造函数语法、`ArgumentNullException`空值检查、接口抽象、适当的服务生命周期
- **存储库模式**：异步数据访问接口提供程序连接抽象
- **提供程序模式**：外部服务抽象（数据库、AI）、清晰合同、配置处理
- **资源模式**：ResourceManager用于本地化消息、单独的.resx文件（LogMessages、ErrorMessages）

## 审查清单

- **设计模式**：识别使用的模式。命令处理器、工厂、提供程序和存储库模式是否正确实现？是否缺少有益的模式？
- **架构**：遵循命名空间约定（`{Core|Console|App|Service}.{Feature}`）？Core/Console项目之间有适当分离？模块化和可读？
- **.NET最佳实践**：主构造函数、async/await与Task返回、ResourceManager使用、结构化日志记录、强类型配置？
- **GoF模式**：命令、工厂、模板方法、策略模式是否正确实现？
- **SOLID原则**：单一职责、开闭、里氏替换、接口隔离、依赖倒置违规？
- **性能**：适当的async/await、资源释放、ConfigureAwait(false)、并行处理机会？
- **可维护性**：清晰的关注点分离、一致的错误处理、适当的配置使用？
- **可测试性**：通过接口抽象依赖、可模拟组件、异步可测试性、AAA模式兼容性？
- **安全性**：输入验证、安全凭据处理、参数化查询、安全异常处理？
- **文档**：公共API的XML文档、参数/返回描述、资源文件组织？
- **代码清晰度**：反映域概念的有意义名称、通过模式表达清晰意图、自解释结构？
- **清洁代码**：一致的风格、适当的方法/类大小、最小复杂性、消除重复？

## 改进重点领域

- **命令处理器**：基类中的验证、一致的错误处理、适当的资源管理
- **工厂**：依赖配置、服务提供程序集成、释放模式
- **提供程序**：连接管理、异步模式、异常处理和日志记录
- **配置**：数据注释、验证属性、安全敏感值处理
- **AI/ML集成**：语义内核模式、结构化输出处理、模型配置

提供与项目架构和.NET最佳实践一致的、具体的、可操作的改进建议。