---
description: 'ReactJS开发标准和最佳实践'
applyTo: '**/*.jsx, **/*.tsx, **/*.js, **/*.ts, **/*.css, **/*.scss'
---

# ReactJS开发指令

使用现代模式、钩子和最佳实践构建高质量ReactJS应用程序的指令，遵循https://react.dev的官方React文档。

## 项目上下文
- 最新React版本（React 19+）
- TypeScript用于类型安全（如适用）
- 默认使用带钩子的函数组件
- 遵循React官方风格指南和最佳实践
- 使用现代构建工具（Vite、Create React App或自定义Webpack设置）
- 实施适当的组件组合和可重用模式

## 开发标准

### 架构
- 使用带钩子的函数组件作为主要模式
- 实施组件组合而不是继承
- 按功能或域组织组件以实现可扩展性
- 清晰分离展示组件和容器组件
- 为可重用状态逻辑使用自定义钩子
- 实施具有清晰数据流的适当组件层次结构

### TypeScript集成
- 为props、状态和组件定义使用TypeScript接口
- 为事件处理器和refs定义适当的类型
- 在适用的地方实施通用组件
- 在`tsconfig.json`中使用严格模式确保类型安全
- 利用React的内置类型（`React.FC`、`React.ComponentProps`等）
- 为组件变体和状态创建联合类型

### 组件设计
- 遵循组件单一职责原则
- 使用描述性和一致的命名约定
- 使用TypeScript或PropTypes实施适当的prop验证
- 设计组件可测试和可重用
- 保持组件小且专注于单一关注点
- 使用组合模式（render props、作为函数的children）

### 状态管理
- 对本地组件状态使用`useState`
- 对复杂状态逻辑实施`useReducer`
- 利用`useContext`在组件树间共享状态
- 考虑外部状态管理（Redux Toolkit、Zustand）用于复杂应用程序
- 实施适当的状态规范化和数据结构
- 使用React Query或SWR进行服务器状态管理

### 钩子和效果
- 使用具有适当依赖数组的`useEffect`以避免无限循环
- 在效果中实施清理函数以防止内存泄漏
- 在需要时使用`useMemo`和`useCallback`进行性能优化
- 为可重用状态逻辑创建自定义钩子
- 遵循钩子规则（仅在顶层调用）
- 使用`useRef`访问DOM元素和存储可变值

### 样式
- 使用CSS Modules、Styled Components或现代CSS-in-JS解决方案
- 使用移动优先方法实施响应式设计
- 遵循BEM方法论或类似的CSS类命名约定
- 使用CSS自定义属性（变量）进行主题化
- 实施一致的间距、排版和颜色系统
- 使用适当的ARIA属性和语义HTML确保可访问性

### 性能优化
- 在适当时使用`React.memo`进行组件记忆化
- 使用`React.lazy`和`Suspense`实施代码分割
- 通过树摇和动态导入优化包大小
- 谨慎使用`useMemo`和`useCallback`以防止不必要的重新渲染
- 为大型列表实施虚拟滚动
- 使用React DevTools分析组件以识别性能瓶颈

### 数据获取
- 使用现代数据获取库（React Query、SWR、Apollo Client）
- 实施适当的加载、错误和成功状态
- 处理竞争条件和请求取消
- 使用乐观更新以获得更好的用户体验
- 实施适当的缓存策略
- 优雅处理离线场景和网络错误

### 错误处理
- 为组件级错误处理实施错误边界
- 在数据获取中使用适当的错误状态
- 为错误场景实施回退UI
- 适当记录错误以便调试
- 在效果和事件处理器中处理异步错误
- 向用户提供有意义的错误消息

### 表单和验证
- 对表单输入使用受控组件
- 使用Formik、React Hook Form等库实施适当的表单验证
- 适当处理表单提交和错误状态
- 为表单实施可访问性功能（标签、ARIA属性）
- 使用防抖验证以获得更好的用户体验
- 处理文件上传和复杂表单场景

### 路由
- 使用React Router进行客户端路由
- 实施嵌套路由和路由保护
- 适当处理路由参数和查询字符串
- 为基于路由的代码分割实施懒加载
- 使用适当的导航模式和后退按钮处理
- 实施面包屑和导航状态管理

### 测试
- 使用React Testing Library为组件编写单元测试
- 测试组件行为，而不是实现细节
- 使用Jest作为测试运行器和断言库
- 为复杂组件交互实施集成测试
- 适当模拟外部依赖和API调用
- 测试可访问性功能和键盘导航

### 安全性
- 清理用户输入以防止XSS攻击
- 在渲染前验证和转义数据
- 对所有外部API调用使用HTTPS
- 实施适当的身份验证和授权模式
- 避免在localStorage或sessionStorage中存储敏感数据
- 使用内容安全策略（CSP）头

### 可访问性
- 适当使用语义HTML元素
- 实施适当的ARIA属性和角色
- 确保所有交互元素的键盘导航工作正常
- 为图像和描述性文本提供alt文本的图标
- 实施适当的颜色对比度比率
- 使用屏幕阅读器和可访问性工具进行测试

## 实施过程
1. 规划组件架构和数据流
2. 使用适当的文件夹组织设置项目结构
3. 定义TypeScript接口和类型
4. 实施具有适当样式的核心组件
5. 添加状态管理和数据获取逻辑
6. 实施路由和导航
7. 添加表单处理和验证
8. 实施错误处理和加载状态
9. 为组件和功能添加测试覆盖
10. 优化性能和包大小
11. 确保可访问性合规
12. 添加文档和代码注释

## 附加指南
- 遵循React的命名约定（组件使用PascalCase，函数使用camelCase）
- 使用有意义的提交消息并保持干净的git历史
- 实施适当的代码分割和懒加载策略
- 使用JSDoc记录复杂组件和自定义钩子
- 使用ESLint和Prettier保持一致的代码格式
- 保持依赖项最新并审计安全漏洞
- 为不同部署阶段实施适当的环境配置
- 使用React Developer Tools进行调试和性能分析

## 常见模式
- 用于横切关注点的高阶组件（HOCs）
- 用于组件组合的render props模式
- 用于相关功能的复合组件
- 用于基于上下文的状态共享的Provider模式
- 容器/展示组件分离
- 用于可重用逻辑提取的自定义钩子