---
description: '创建高质量自定义指令文件以指导 GitHub Copilot 的指南'
applyTo: '**/*.instructions.md'
---

# 自定义指令文件指南

创建有效且可维护的自定义指令文件，指导 GitHub Copilot 生成特定领域代码并遵循项目约定的说明。

## 项目上下文

- 目标受众：使用特定领域代码的开发者和 GitHub Copilot
- 文件格式：带有 YAML 前置内容的 Markdown
- 文件命名约定：小写字母加连字符（例如：`react-best-practices.instructions.md`）
- 位置：`.github/instructions/` 目录
- 目的：为代码生成、审查和文档编写提供上下文感知的指导

## 必需的前置内容

每个指令文件必须包含包含以下字段的 YAML 前置内容：

```yaml
---
description: '指令目的和范围的简要描述'
applyTo: '目标文件的 glob 模式（例如：**/*.ts, **/*.py）'
---
```

### 前置内容指南

- **description**：单引号字符串，1-500个字符，清晰说明目的
- **applyTo**：指定这些指令适用于哪些文件的 glob 模式
  - 单个模式：`'**/*.ts'`
  - 多个模式：`'**/*.ts, **/*.tsx, **/*.js'`
  - 特定文件：`'src/**/*.py'`
  - 所有文件：`'**'`

## 文件结构

结构良好的指令文件应包含以下部分：

### 1. 标题和概述

- 使用 `#` 标题的清晰、描述性标题
- 解释目的和范围的简要介绍
- 可选：包含关键技术和版本的项目上下文部分

### 2. 核心部分

根据领域将内容组织为逻辑部分：

- **一般指令**：高级指南和原则
- **最佳实践**：推荐的模式和方法
- **代码标准**：命名约定、格式化、样式规则
- **架构/结构**：项目组织和设计模式
- **常见模式**：经常使用的实现方式
- **安全性**：安全考虑（如适用）
- **性能**：优化指南（如适用）
- **测试**：测试标准和方法（如适用）

### 3. 示例和代码片段

提供带有清晰标签的具体示例：

```markdown
### 好的示例
\`\`\`language
// 推荐的方法
代码示例
\`\`\`

### 坏的示例
\`\`\`language
// 避免这种模式
代码示例
\`\`\`
```

### 4. 验证和确认（可选但推荐）

- 验证代码的构建命令
- 代码检查和格式化工具
- 测试要求
- 验证步骤

## 内容指南

### 写作风格

- 使用清晰、简洁的语言
- 使用祈使语气写作（"使用"、"实现"、"避免"）
- 具体且可操作
- 避免模糊术语如"应该"、"可能"、"或许"
- 使用项目符号和列表提高可读性
- 保持部分集中且易于浏览

### 最佳实践

- **具体化**：提供具体示例而非抽象概念
- **说明原因**：在增加价值时解释建议背后的原因
- **使用表格**：用于比较选项、列出规则或显示模式
- **包含示例**：真实代码片段比描述更有效
- **保持最新**：引用当前版本和最佳实践
- **链接资源**：包含官方文档和权威来源

### 常见的包含模式

1. **命名约定**：如何命名变量、函数、类、文件
2. **代码组织**：文件结构、模块组织、导入顺序
3. **错误处理**：首选的错误处理模式
4. **依赖关系**：如何管理和文档化依赖关系
5. **注释和文档**：何时以及如何文档化代码
6. **版本信息**：目标语言/框架版本

## 遵循的模式

### 项目符号和列表

```markdown
## 安全最佳实践

- 在处理前总是验证用户输入
- 使用参数化查询防止 SQL 注入
- 将机密信息存储在环境变量中，绝不存储在代码中
- 实现适当的身份验证和授权
- 为所有生产端点启用 HTTPS
```

### 结构化信息表格

```markdown
## 常见问题

| 问题            | 解决方案            | 示例                          |
| --------------- | ------------------- | ----------------------------- |
| 魔数            | 使用命名常量        | `const MAX_RETRIES = 3`       |
| 深层嵌套        | 提取函数            | 重构嵌套的 if 语句            |
| 硬编码值        | 使用配置            | 将 API URL 存储在配置中       |
```

### 代码比较

```markdown
### 好的示例 - 使用 TypeScript 接口
\`\`\`typescript
interface User {
  id: string;
  name: string;
  email: string;
}

function getUser(id: string): User {
  // 实现
}
\`\`\`

### 坏的示例 - 使用 any 类型
\`\`\`typescript
function getUser(id: any): any {
  // 失去类型安全
}
\`\`\`
```

### 条件指导

```markdown
## 框架选择

- **对于小型项目**：使用最小 API 方法
- **对于大型项目**：使用基于控制器的架构，明确分离
- **对于微服务**：考虑领域驱动设计模式
```

## 避免的模式

- **过度冗长的解释**：保持简洁且易于浏览
- **过时信息**：总是引用当前版本和实践
- **模糊指南**：具体说明要做什么或避免什么
- **缺少示例**：没有具体代码示例的抽象规则
- **矛盾建议**：确保整个文件的一致性
- **从文档复制粘贴**：通过提炼和情境化来增加价值

## 测试您的指令

在最终确定指令文件之前：

1. **使用 Copilot 测试**：在 VS Code 中使用实际提示尝试指令
2. **验证示例**：确保代码示例正确且无错误运行
3. **检查 Glob 模式**：确认 `applyTo` 模式匹配预期文件

## 示例结构

这是一个新指令文件的最小示例结构：

```markdown
---
description: '目的的简要描述'
applyTo: '**/*.ext'
---

# 技术名称开发

简要介绍和上下文。

## 一般指令

- 高级指南 1
- 高级指南 2

## 最佳实践

- 具体实践 1
- 具体实践 2

## 代码标准

### 命名约定
- 规则 1
- 规则 2

### 文件组织
- 结构 1
- 结构 2

## 常见模式

### 模式 1
描述和示例

\`\`\`language
代码示例
\`\`\`

### 模式 2
描述和示例

## 验证

- 构建命令：`验证命令`
- 代码检查：`检查命令`
- 测试：`测试命令`
```

## 维护

- 当依赖项或框架更新时审查指令
- 更新示例以反映当前最佳实践
- 删除过时的模式或弃用的功能
- 随着社区中出现新模式而添加
- 随着项目结构演变保持 glob 模式准确

## 其他资源

- [自定义指令文档](https://code.visualstudio.com/docs/copilot/customization/custom-instructions)
- [优秀的 Copilot 指令](https://github.com/github/awesome-copilot/tree/main/instructions)