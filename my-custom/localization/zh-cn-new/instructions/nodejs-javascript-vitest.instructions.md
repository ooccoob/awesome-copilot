---
description: "编写 Node.js 和 JavaScript 代码以及 Vitest 测试的指南"
applyTo: '**/*.js, **/*.mjs, **/*.cjs'
---

# 代码生成指南

## 编码标准
- 使用具有 ES2022 特性的 JavaScript 和 Node.js (20+) ESM 模块
- 使用 Node.js 内置模块，尽可能避免外部依赖
- 在添加任何额外依赖之前询问用户
- 始终对异步代码使用 async/await，并使用 'node:util' promisify 函数避免回调
- 保持代码简单和可维护
- 使用描述性变量和函数名称
- 除非绝对必要，否则不要添加注释，代码应该不言自明
- 绝不使用 `null`，对可选值始终使用 `undefined`
- 优先选择函数而非类

## 测试
- 使用 Vitest 进行测试
- 为所有新功能和错误修复编写测试
- 确保测试覆盖边缘情况和错误处理
- 绝不更改原始代码以使其更容易测试，相反，编写覆盖原始代码现状的测试

## 文档
- 添加新功能或进行重大更改时，在必要时更新 README.md 文件

## 用户交互
- 如果不确定实现细节、设计选择或需要明确要求，请提出问题
- 始终以与问题相同的语言回答，但对生成的内容如代码、注释或文档使用英语