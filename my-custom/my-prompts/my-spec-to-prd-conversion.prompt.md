# Spec 文档转 PRD 文档生成指南

## 一、文档定位与目标

本 Prompt 用于将技术规范文档 (Spec) 转换为产品需求文档 (PRD)，生成的 PRD 文档将作为前端开发团队的核心指导文档。

### 核心原则
1. **面向前端开发者**：所有内容从前端开发视角编写，提供前端实现所需的完整信息
2. **用户体验优先**：强调用户交互流程、界面设计、操作反馈等 UX 要素
3. **可执行性**：每个需求都应清晰、可测试、可实现
4. **完整性**：包含前端开发所需的所有信息（API、数据结构、交互逻辑、边界情况等）

---

## 二、PRD 文档结构模板

按照以下结构组织 PRD 文档内容：

```markdown
# PRD: [模块中文名称]

## 1. Product overview

### 1.1 Document title and version
* PRD: [完整标题]
* Version: 1.0
* Created: [生成日期]
* Target Audience: 前端开发团队

### 1.2 Product summary
[3-5段产品概述，回答以下问题：]
- 这个模块是什么？
- 它解决什么问题？
- 核心功能有哪些？
- 为什么重要？
- 给用户带来什么价值？

## 2. Goals

### 2.1 Business goals
[列举5-7个业务目标，使用bullet points]

### 2.2 User goals
[列举5-7个用户目标，使用bullet points]

### 2.3 Non-goals
[列举5-10个明确不在本版本范围内的功能]

## 3. User personas

### 3.1 Key user types
[列出所有用户角色类型]

### 3.2 Basic persona details
[为每个角色提供详细描述：职责、技能水平、使用场景]

### 3.3 Role-based access
[说明每个角色的权限范围和可访问功能]

## 4. Functional requirements

[按优先级分组列举功能需求]

* **[功能名称]** (Priority: High/Medium/Low)
  * [子功能1]
  * [子功能2]
  * [子功能3...]

## 5. User experience

### 5.1 Entry points & first-time user flow
[描述用户如何进入模块、首次使用的引导流程]

### 5.2 Core experience
[描述核心用户场景的完整交互流程]

### 5.3 Advanced features & edge cases
[列举高级功能和边界情况处理]

### 5.4 UI/UX highlights
[强调关键的 UI/UX 设计要点]

## 6. Narrative

[用故事化的方式描述一个完整的用户使用场景]
[包含：用户背景、操作步骤、遇到的问题、如何解决、最终结果]
[长度：500-800字]

## 7. Success metrics

### 7.1 User-centric metrics
[用户体验相关指标]

### 7.2 Business metrics
[业务价值相关指标]

### 7.3 Technical metrics
[技术性能相关指标]

## 8. Technical considerations

### 8.1 Integration points
[前后端集成点、依赖的系统和组件]

### 8.2 Data storage & privacy
[数据安全、隐私保护要求]

### 8.3 Scalability & performance
[性能优化、可扩展性考虑]

### 8.4 Potential challenges
[潜在技术挑战和风险]

## 9. Milestones & sequencing

### 9.1 Project estimate
[项目规模估算]

### 9.2 Team size & composition
[团队配置建议]

### 9.3 Suggested phases
[分阶段实施计划]

## 10. User stories

### 10.1. [用户故事标题]
* **ID**: [模块缩写]-[序号]
* **Description**: 作为[角色],我需要[功能],以便[目标]
* **Acceptance criteria**:
  * [验收标准1]
  * [验收标准2]
  * [验收标准3...]

[重复以上结构，为每个核心功能创建用户故事]

## 11. UI/UX 详细设计

**🎯 前端代码生成器依赖：此章节为前端代码生成的核心依据，必须包含完整的UI组件定义**

### 11.1 页面布局（必需）
#### 11.1.1 整体布局结构
**要求**：使用ASCII艺术图展示完整的页面结构，必须包含：
- 页面标题区域
- 搜索/筛选区域（如有）
- 操作按钮区域
- 数据表格区域
- 分页组件位置

**示例模板**：
```
┌─────────────────────────────────────────────────────────────────┐
│ 页面标题: XXX管理                                                 │
├─────────────────────────────────────────────────────────────────┤
│ [搜索区域]                                                        │
│ 字段1: [_____] 字段2: [___▼] [查询] [重置]                      │
├─────────────────────────────────────────────────────────────────┤
│ [新增XXX] [导出] 等操作按钮                                       │
├─────────────────────────────────────────────────────────────────┤
│ [数据表格区域]                                                    │
│ ┌─────┬──────┬─────┬────┬──────┬─────┐                         │
│ │序号│列名1│列名2│...│创建时间│操作│                            │
│ └─────┴──────┴─────┴────┴──────┴─────┘                         │
├─────────────────────────────────────────────────────────────────┤
│ [分页组件] 共 X 条                                               │
└─────────────────────────────────────────────────────────────────┘
```

#### 11.1.2 新增/编辑弹窗布局
**要求**：使用ASCII艺术图展示表单结构，必须包含：
- 弹窗标题
- 表单字段排列方式（单列/双列）
- 底部按钮区域

**示例模板**：
```
┌──────────────────────────────────────────┐
│  ● 新增XXX / 编辑XXX                      │
├──────────────────────────────────────────┤
│  字段1 *: [_________________]            │
│  字段2 *: [下拉选择 ▼]                   │
│  字段3:   [_________________]            │
│  描述:    ┌─────────────────┐            │
│          │  (文本域)        │            │
│          └─────────────────┘            │
├──────────────────────────────────────────┤
│              [取消] [保存]                │
└──────────────────────────────────────────┘
```

### 11.2 组件规范（必需）
#### 11.2.1 表格列定义（必需）
**要求**：使用表格形式定义**所有列**，每列必须包含以下属性：

| 列标识 | 列名 | 字段名 | 类型 | 宽度 | 对齐 | 可排序 | 说明 | 特殊处理 |
|--------|------|--------|------|------|------|--------|------|----------|
| index | 序号 | - | index | 60 | center | 否 | 自动序号 | type="index" |
| [根据Spec定义具体列] | [显示名称] | [后端字段名] | text/tag/datetime | [像素值] | left/center/right | 是/否 | [用途说明] | [组件属性/格式化方法] |
| ... | ... | ... | ... | ... | ... | ... | ... | ... |
| action | 操作 | - | action | 200 | center | 否 | 操作按钮列 | fixed="right" |

**类型说明**：
- `text`: 普通文本，使用 `show-overflow-tooltip`
- `tag`: 标签显示，需定义颜色映射（如状态）
- `datetime`: 时间字段，需格式化
- `number`: 数字字段，可指定精度
- `action`: 操作按钮列

**必须明确**：操作列包含哪些按钮（编辑/删除/查看/其他）

#### 11.2.2 表单字段规范（必需）
**要求**：使用表格形式定义**所有表单字段**，每个字段必须包含：

| 字段标识 | 字段标签 | 组件类型 | 必填 | 默认值 | 验证规则 | 占位提示 | 说明 | 特殊处理 |
|----------|----------|----------|------|--------|----------|----------|------|----------|
| [fieldName] | [标签名]* | hos-input/hos-select/... | 是/否 | [默认值] | [规则描述] | [placeholder] | [字段说明] | [组件特殊属性] |

**组件类型枚举**：
- `hos-input`: 文本输入框
- `hos-select`: 下拉选择
- `hos-input-number`: 数字输入
- `hos-date-picker`: 日期选择
- `hos-switch`: 开关
- `hos-radio`: 单选
- `hos-checkbox`: 多选
- `hos-textarea`: 文本域

**验证规则格式**（必需）：
```javascript
// 必须提供可直接使用的验证规则
rules: {
  [fieldName]: [
    { required: true/false, message: 'XXX', trigger: 'blur' },
    { min: X, max: Y, message: 'XXX', trigger: 'blur' },
    { pattern: /正则表达式/, message: 'XXX', trigger: 'blur' },
    { validator: asyncValidatorName, trigger: 'blur' } // 如需异步验证
  ]
}
```

**特殊字段处理规则**（必需）：
- 密码字段：编辑时显示"******"，提示"留空表示不修改"
- 自动填充字段：说明触发条件和填充逻辑（如：选择数据库类型后自动填充端口）
- 级联字段：说明依赖关系（如：选择连接后加载数据库列表）

#### 11.2.3 按钮规范（必需）
**要求**：定义**所有按钮**的完整属性

| 按钮名称 | 位置 | 类型 | 尺寸 | 权限码 | 状态控制 | 点击行为 | 二次确认 |
|----------|------|------|------|--------|----------|----------|----------|
| [按钮文本] | [位置描述] | primary/default/text | default/small | [权限码或-] | loading/disabled | [调用的方法/API] | 是/否 |

**必须包含的按钮**：
- 新增按钮（如有）
- 查询/重置按钮（如有搜索）
- 表格操作列按钮（编辑/删除/...）
- 表单底部按钮（取消/保存/测试等）

### 11.3 交互规范（必需）
#### 11.3.1 加载状态
**要求**：定义**所有加载场景**的UI表现

| 场景 | 加载方式 | 提示文案 | 遮罩范围 |
|------|----------|----------|----------|
| 列表查询 | `v-loading="tableLoading"` | "加载中..." | 表格区域 |
| 表单提交 | 按钮`:loading="submitting"` | - | 按钮本身 |
| [其他场景] | [实现方式] | [提示文案] | [遮罩范围] |

#### 11.3.2 错误状态
**要求**：定义**所有错误场景**的提示方式

| 错误类型 | 触发条件 | 提示文案模板 | 提示类型 | 持续时间 | 额外处理 |
|----------|----------|--------------|----------|----------|----------|
| 网络错误 | 请求超时/失败 | "网络异常,请稍后重试" | error | 3秒 | - |
| 权限错误 | 401/403 | "权限不足" | warning | 2秒 | 跳转登录/隐藏按钮 |
| 验证错误 | 表单验证失败 | [字段规则中的message] | - | - | 标红字段 |
| 业务错误 | code != 200 | [后端返回的msg] | error | 3秒 | 保持表单数据 |
| [其他场景] | [触发条件] | [提示文案] | [类型] | [时间] | [处理] |

#### 11.3.3 成功反馈
**要求**：定义**所有成功场景**的反馈机制

| 操作 | 提示文案 | 提示类型 | 持续时间 | 后续动作 |
|------|----------|----------|----------|----------|
| 新增成功 | "新增成功" | success | 2秒 | 关闭表单+刷新列表 |
| 编辑成功 | "修改成功" | success | 2秒 | 关闭表单+刷新列表 |
| 删除成功 | "删除成功" | success | 2秒 | 刷新列表 |
| [其他操作] | [提示文案] | success | 2秒 | [后续动作] |

#### 11.3.4 空状态
**要求**：定义**所有空数据场景**的展示

| 场景 | 展示位置 | 提示文案 | 引导操作 |
|------|----------|----------|----------|
| 列表无数据 | 表格中央 | "暂无数据,点击'新增XXX'开始配置" | 新增按钮引导 |
| 搜索无结果 | 表格中央 | "未找到符合条件的记录" | 调整搜索条件 |
| [其他场景] | [位置] | [文案] | [引导] |

### 11.4 状态与标签规范（必需，如模块有状态字段）

#### 11.4.1 状态枚举定义
**要求**：如模块包含状态字段，必须定义状态枚举及展示规则

| 状态值 | 显示文本 | 标签类型 | 颜色 | 说明 |
|--------|----------|----------|------|------|
| [STATUS_VALUE] | [显示名称] | success/warning/info/danger | [颜色描述] | [状态说明] |

**必须提供的方法示例**：
```javascript
methods: {
  getStatusTagType(status) {
    const typeMap = { ... };
    return typeMap[status] || '';
  },
  getStatusLabel(status) {
    const labelMap = { ... };
    return labelMap[status] || status;
  }
}
```

#### 11.4.2 状态流转规则（如涉及状态变更）
**要求**：定义状态机和流转条件

| 当前状态 | 目标状态 | 操作按钮 | 前置条件 | 后端接口 |
|----------|----------|----------|----------|----------|
| [状态A] | [状态B] | [按钮文本] | [校验条件] | [API路径] |

### 11.5 默认值与联动规则（必需，如有联动字段）

**要求**：定义字段的默认值和自动填充逻辑

| 触发字段 | 联动字段 | 填充规则 | 示例 |
|----------|----------|----------|------|
| [fieldA] | [fieldB] | [触发时机+填充逻辑] | [具体示例] |

**示例**：
```javascript
// 必须提供可直接使用的联动逻辑
handleFieldChange(value) {
  if (value === 'XXX') {
    this.form.linkedField = 'YYY';
  }
}
```

## 12. API 集成规范

**🎯 前端代码生成器依赖：此章节为API接口封装的直接依据，必须包含完整的接口定义**

### 12.1 API 接口清单（必需）
**要求**：使用表格形式列出**所有API接口**，每个接口必须包含：

| 接口编号 | 接口名称 | 接口路径 | 请求方法 | 权限要求 | 优先级 | 说明 |
|----------|----------|----------|----------|----------|--------|------|
| API-001 | [功能描述] | /[module]/[action] | GET/POST | [权限码] | P0/P1/P2 | [接口用途] |

**标准接口（基础模块必须包含）**：
- 分页查询列表：`POST /[module]/selectPageList`
- 新增记录：`POST /[module]/save`
- 更新记录：`POST /[module]/update`
- 批量删除：`POST /[module]/batchDeleteByIds`
- 查询详情：`GET /[module]/getDetailById`

**扩展接口（根据Spec按需定义）**：
- 唯一性检查：`GET /[module]/check[Field]Exists`
- 下拉选项：`GET /[module]/getSelectList`
- 状态变更：`POST /[module]/updateStatus`
- 其他业务接口：根据Spec定义

### 12.2 接口详细定义（必需）
**要求**：为**每个接口**提供完整定义，使用以下统一模板：

#### API-XXX: [接口名称]

**基本信息**：
- **接口路径**：`[METHOD] /[full-path]`
- **接口说明**：[功能描述]
- **权限要求**：`[permission-code]` 或 "无"
- **超时时间**：[X]秒

**请求参数**：

| 参数名 | 类型 | 位置 | 必填 | 默认值 | 说明 | 验证规则 | 示例 |
|--------|------|------|------|--------|------|----------|------|
| [paramName] | String/Integer/Boolean/Array | params/data | 是/否 | [value] | [说明] | [规则] | [example] |

**位置说明**：
- `params`: GET请求参数或POST请求的URL参数
- `data`: POST请求体

**请求示例**：
```json
{
  "[paramName]": [示例值],
  ...
}
```

**响应结构**：

**成功响应 (code=200)**：
```json
{
  "code": 200,
  "msg": "[成功提示]",
  "data": {
    // 根据接口类型定义data结构
    // 列表查询: { records: [...], total: X, current: X, size: X }
    // 新增/修改/删除: true/false 或 对象
    // 详情查询: { 完整对象 }
  }
}
```

**失败响应示例**：
```json
{
  "code": [错误码],
  "msg": "[错误描述]",
  "data": null
}
```

**错误码说明**：
| 错误码 | 说明 | 前端处理 |
|--------|------|----------|
| 200 | 成功 | 正常处理 |
| 400 | 参数错误 | 显示错误信息 |
| 401 | 未授权 | 跳转登录 |
| 403 | 权限不足 | 提示权限不足 |
| [业务码] | [业务错误] | [处理方式] |

**前端调用示例**：
```javascript
// 必须提供可直接使用的调用代码
async [methodName]() {
  try {
    const res = await this.$api('[module].[apiName]', [params/data]);
    if (res.code === 200) {
      // 成功处理
    }
  } catch (error) {
    // 错误处理
  }
}
```

### 12.3 数据模型定义（必需）
**要求**：定义前端使用的**所有数据模型**

#### 12.3.1 列表数据模型 (ListVO)
**用途**：列表查询返回的记录对象

| 字段名 | 类型 | 必含 | 说明 | 示例值 | 前端处理 |
|--------|------|------|------|--------|----------|
| id | String | 是 | 主键UUID | "uuid-string" | 用于编辑/删除 |
| [根据Spec定义业务字段] | [类型] | 是/否 | [说明] | [示例] | [处理方式] |
| status | String | 否 | 状态（如有） | "ENABLED" | 转标签展示 |
| createTime | String | 是 | 创建时间 | "2025-01-01 10:00:00" | 格式化显示 |
| updateTime | String | 是 | 更新时间 | "2025-01-01 10:00:00" | 格式化显示 |
| createBy | String | 否 | 创建人 | "admin" | 详情显示 |
| updateBy | String | 否 | 更新人 | "admin" | 详情显示 |

**TypeScript 类型定义**（可选但推荐）：
```typescript
interface [Module]ListVO {
  id: string;
  [fieldName]: [type];
  ...
  createTime: string;
  updateTime: string;
}
```

#### 12.3.2 表单数据模型 (FormDTO)
**用途**：新增/编辑表单的数据结构

| 字段名 | 类型 | 新增必填 | 编辑必填 | 默认值 | 说明 |
|--------|------|----------|----------|--------|------|
| id | String | 否 | 是 | null | 编辑时必传 |
| [根据Spec定义表单字段] | [类型] | 是/否 | 是/否 | [默认值] | [说明] |

**Vue data 初始化示例**：
```javascript
form: {
  id: null,
  [fieldName]: [defaultValue],
  ...
}
```

#### 12.3.3 详情数据模型 (DetailVO)（如有详情接口）
**用途**：详情查询返回的完整对象

[包含 ListVO 的所有字段，补充额外字段]

| 字段名 | 类型 | 说明 | 示例值 |
|--------|------|------|--------|
| [额外字段] | [类型] | [说明] | [示例] |

#### 12.3.4 枚举类型定义（如有枚举字段）
**要求**：定义所有枚举类型及其展示映射

**[EnumName] 枚举**：
| 枚举值 | 显示文本 | 说明 | 标签类型 | 使用场景 |
|--------|----------|------|----------|----------|
| [VALUE] | [文本] | [说明] | success/warning/info | [场景] |

**前端枚举定义**：
```javascript
// src/biz/enum/[module].js
export const [ENUM_NAME]_OPTIONS = [
  { label: '[文本]', value: '[VALUE]' }
];

export const [ENUM_NAME]_TAG_MAP = {
  '[VALUE]': 'success'
};

export const [ENUM_NAME]_LABEL_MAP = {
  '[VALUE]': '[文本]'
};
```

### 12.4 状态码与错误处理规范（必需）

#### 12.4.1 HTTP 状态码
**标准映射**（无需每个Spec重复定义）：

| 状态码 | 说明 | 前端处理 |
|--------|------|----------|
| 200 | 成功 | 正常处理 |
| 401 | 未授权 | 跳转登录 |
| 403 | 权限不足 | 提示权限不足 |
| 404 | 资源不存在 | 提示不存在 |
| 500 | 服务器错误 | 提示稍后重试 |

#### 12.4.2 业务状态码 (code)
**要求**：定义模块**特有的业务错误码**

| 业务码 | 说明 | 前端提示文案 | 交互行为 |
|--------|------|--------------|----------|
| 200 | 成功 | [后端msg] | 正常处理 |
| 400 | 参数错误 | [后端msg] | 保持表单 |
| [自定义码] | [业务错误] | [提示文案] | [处理方式] |

**常见业务错误码**（根据Spec定义）：
- 唯一性冲突：如 `10001`
- 依赖关系冲突：如 `10002`
- 状态不允许：如 `10003`
- 数据验证失败：如 `10004`

#### 12.4.3 错误场景与提示文案（必需）
**要求**：定义**所有可预见的错误场景**

| 场景分类 | 具体场景 | 错误码 | 前端提示文案 | 提示类型 | 持续时间 | 额外处理 |
|----------|----------|--------|--------------|----------|----------|----------|
| 网络类 | 网络超时 | timeout | "网络超时,请检查网络" | error | 3秒 | 重试提示 |
| 权限类 | 未登录 | 401 | "登录已过期" | warning | 2秒 | 跳转登录 |
| 验证类 | 唯一性冲突 | 10001 | "[字段]已存在" | warning | 3秒 | 定位字段 |
| 业务类 | [根据Spec定义] | [码] | [文案] | [类型] | [时间] | [处理] |

### 12.5 API接口文件生成模板（必需）
**要求**：基于上述接口定义，生成可直接使用的API文件结构

```javascript
/**
 * [模块名称] API 接口封装
 * @module api/[module-name]
 */

/**
 * 分页查询列表
 * @param {Object} params - 查询参数
 * @returns {Object} API配置对象
 */
export const selectPageList = (params) => ({
  url: '/[module-path]/selectPageList',
  method: 'post',
  params
});

// 根据 12.1 接口清单生成所有接口...
```

## 13. 前端实现要求

**🎯 前端代码生成器依赖：此章节定义代码生成的技术规范和实现约束**

### 13.1 技术栈声明（必需）
**要求**：明确列出本模块使用的技术栈

| 技术类别 | 技术选型 | 版本要求 | 说明 |
|----------|----------|----------|------|
| 前端框架 | Vue.js | 2.x | [说明] |
| UI组件库 | HosUI | [版本] | [说明] |
| 状态管理 | Vuex | [版本] | [是否使用/使用场景] |
| HTTP库 | Axios | [版本] | [封装方式] |
| 样式语言 | SCSS | - | [预处理方式] |

### 13.2 目录结构规范（必需）
**要求**：定义本模块的文件结构

```
src/biz/
├── views/
│   └── [module-name]/           # 模块主目录
│       ├── index.vue             # 列表主页面（必需）
│       └── components/           # 组件目录（必需）
│           ├── [Module]Form.vue  # 新增/编辑表单（必需）
│           └── [Module]Detail.vue # 详情组件（如有详情需求）
├── api/
│   └── [module-name].js          # API接口封装（必需）
├── enum/
│   └── [module-name].js          # 枚举定义（如有枚举字段）
└── ...
```

**文件命名约定**：
- 主页面：`index.vue`（固定名称）
- 表单组件：`[PascalCase模块名]Form.vue`
- 详情组件：`[PascalCase模块名]Detail.vue`
- API文件：`[kebab-case模块名].js`
- 枚举文件：`[kebab-case模块名].js`

### 13.3 路由配置规范（必需）
**要求**：定义路由注册信息

| 配置项 | 值 | 说明 |
|--------|-----|------|
| 路由路径 | `/[module-path]` | [路径说明] |
| 路由名称 | `[ModuleName]` | PascalCase命名 |
| 组件路径 | `@/views/[module-name]/index` | 相对路径 |
| 菜单编码 | `[menuCode]` | 权限控制用 |
| 页面标题 | `[pageTitle]` | 页面显示名称 |
| 是否缓存 | true/false | keep-alive配置 |

**路由配置示例**：
```javascript
{
  path: '/[module-path]',
  name: '[ModuleName]',
  component: () => import('@/views/[module-name]/index'),
  meta: {
    title: '[pageTitle]',
    menuCode: '[menuCode]',
    keepAlive: true
  }
}
```

### 13.4 权限控制规范（必需）

#### 13.4.1 权限码清单
**要求**：定义**所有权限点**及其权限码

| 权限点 | 权限码 | 控制对象 | 说明 |
|--------|--------|----------|------|
| 查询列表 | `[module]:query` | 列表查询按钮、API调用 | 基础权限 |
| 新增 | `[module]:add` | 新增按钮、保存API | [说明] |
| 编辑 | `[module]:edit` | 编辑按钮、更新API | [说明] |
| 删除 | `[module]:delete` | 删除按钮、删除API | [说明] |
| [其他业务权限] | `[module]:[action]` | [对象] | [说明] |

#### 13.4.2 权限指令使用
**要求**：说明权限指令的使用方式

```vue
<!-- 按钮级权限 -->
<hos-button v-permission="'[permission-code]'" @click="handleAdd">新增</hos-button>

<!-- 功能块级权限 -->
<div v-permission="'[permission-code]'">
  <!-- 功能内容 -->
</div>
```

### 13.5 表单验证规范（必需）

#### 13.5.1 验证规则清单
**要求**：为**每个表单字段**定义验证规则

| 字段名 | 规则类型 | 验证时机 | 规则配置 | 错误提示 | 特殊说明 |
|--------|----------|----------|----------|----------|----------|
| [fieldName] | required | blur/change | required: true | "请输入[字段名]" | - |
| [fieldName] | pattern | blur | pattern: /正则/ | "格式不正确" | [说明] |
| [fieldName] | length | blur | min: X, max: Y | "长度为X-Y字符" | [说明] |
| [fieldName] | async | blur | validator: checkExists | "[字段]已存在" | 异步校验 |
| [fieldName] | custom | blur | validator: customRule | [自定义提示] | [业务规则] |

#### 13.5.2 验证规则示例
**要求**：提供可直接使用的验证规则代码

```javascript
rules: {
  [fieldName]: [
    { required: true, message: '请输入[字段名]', trigger: 'blur' },
    { min: X, max: Y, message: '长度为X-Y字符', trigger: 'blur' },
    {
      validator: (rule, value, callback) => {
        // 根据12.4.1节定义的验证规则编写
      },
      trigger: 'blur'
    }
  ]
}
```

#### 13.5.3 异步验证规范
**要求**：为**所有唯一性字段**提供异步验证规则

```javascript
// 唯一性校验示例
{
  validator: async (rule, value, callback) => {
    if (!value || (this.form.id && value === this.originalValue)) {
      callback();
      return;
    }
    try {
      const res = await this.$api('[module].check[Field]Exists', { [field]: value });
      if (res.data) {
        callback(new Error('[字段]已存在'));
      } else {
        callback();
      }
    } catch (error) {
      callback(new Error('验证失败'));
    }
  },
  trigger: 'blur'
}
```

### 13.6 状态管理规范（必需）

#### 13.6.1 组件状态清单
**要求**：定义**所有组件级状态**

| 状态名 | 类型 | 初始值 | 用途 | 修改时机 |
|--------|------|--------|------|----------|
| tableLoading | Boolean | false | 表格加载状态 | 列表查询前/后 |
| tableData | Array | [] | 表格数据 | 列表查询后 |
| page | Object | {current:1,size:10,total:0} | 分页信息 | 列表查询后/分页变化 |
| form | Object | {...} | 表单数据 | 表单打开/提交/重置 |
| submitting | Boolean | false | 提交状态 | 提交前/后 |
| [根据Spec定义业务状态] | [类型] | [初始值] | [用途] | [时机] |

#### 13.6.2 状态初始化代码
**要求**：提供可直接使用的data定义

```javascript
data() {
  return {
    // 列表相关
    tableLoading: false,
    tableData: [],
    page: {
      current: 1,
      size: 10,
      total: 0
    },
    queryForm: {
      // 根据11.2.2节定义的查询条件
    },

    // 表单相关
    form: {
      // 根据12.3.2节定义的表单数据模型
    },
    submitting: false,

    // 业务状态（根据Spec定义）
    [stateName]: [initialValue]
  };
}
```

### 13.7 交互与动画规范（必需）

#### 13.7.1 加载状态
**要求**：定义**所有加载状态**的展示方式

| 加载场景 | 加载方式 | 加载文案 | 持续时间 |
|----------|----------|----------|----------|
| 列表查询 | 表格loading | "加载中..." | 直到数据返回 |
| 表单提交 | 按钮loading | "提交中..." | 直到提交完成 |
| [其他场景] | [方式] | [文案] | [时间] |

#### 13.7.2 消息提示
**要求**：定义**所有用户提示**

| 提示场景 | 提示类型 | 提示文案 | 显示时长 | 额外处理 |
|----------|----------|----------|----------|----------|
| 操作成功 | success | "[操作]成功" | 2秒 | 刷新列表/关闭弹窗 |
| 操作失败 | error | 后端msg | 3秒 | - |
| 删除确认 | confirm | "确定删除?" | - | 二次确认 |
| [业务提示] | [类型] | [文案] | [时长] | [处理] |

#### 13.7.3 确认对话框
**要求**：定义**所有需要二次确认**的操作

| 操作类型 | 确认文案 | 确认按钮 | 取消按钮 | 确认后处理 |
|----------|----------|----------|----------|------------|
| 删除 | "确定删除该记录?" | "确定" | "取消" | 调用删除API |
| [业务操作] | [文案] | [按钮] | [按钮] | [处理] |

### 13.8 性能优化要求（必需）

#### 13.8.1 优化策略清单
**要求**：定义**必须实施的性能优化**

| 优化点 | 优化策略 | 实施方式 | 预期效果 |
|--------|----------|----------|----------|
| 列表查询 | 防抖 | 输入框查询延迟300ms | 减少请求次数 |
| 表单验证 | 防抖 | 异步验证延迟500ms | 减少校验请求 |
| 组件缓存 | keep-alive | 路由配置keepAlive:true | 切换不重新渲染 |
| [其他优化] | [策略] | [方式] | [效果] |

#### 13.8.2 防抖节流配置
**要求**：提供防抖节流实现代码（如有需要）

```javascript
// 搜索防抖
handleSearch: debounce(function() {
  this.page.current = 1;
  this.loadData();
}, 300)
```

### 13.9 样式规范（必需）

#### 13.9.1 样式组织
**要求**：定义样式文件结构

```scss
<style lang="scss" scoped>
// 1. 布局容器
.page-container { }

// 2. 查询区域
.query-form { }

// 3. 操作按钮区
.action-bar { }

// 4. 表格区域
.table-container { }

// 5. 分页区域
.pagination-container { }

// 根据11.2节定义的组件添加样式
</style>
```

#### 13.9.2 样式命名约定
**要求**：定义CSS类名命名规则

| 元素类型 | 命名规则 | 示例 |
|----------|----------|------|
| 页面容器 | [module]-container | model-manage-container |
| 查询表单 | query-form | query-form |
| 操作按钮区 | action-bar | action-bar |
| 表格容器 | table-container | table-container |
| [业务元素] | [自定义规则] | [示例] |

### 13.10 注释与文档规范（必需）

#### 13.10.1 文件注释模板
**要求**：每个文件必须包含文件级注释

```javascript
/**
 * [模块名称] - [页面/组件描述]
 * @description [详细描述]
 * @author [作者]
 * @date [创建日期]
 */
```

#### 13.10.2 方法注释模板
**要求**：关键方法必须包含注释

```javascript
/**
 * [方法描述]
 * @param {Type} paramName - 参数说明
 * @returns {Type} 返回值说明
 */
```

#### 13.10.3 README文档要求
**要求**：每个模块必须包含README.md文档

**README.md 必须包含章节**：
1. 模块概述
2. 功能特性
3. 技术栈
4. 目录结构
5. 快速开始
6. API接口说明
7. 组件说明
8. 状态管理
9. 权限控制
10. 常见问题

（具体内容根据Spec和前述章节生成）

## 14. 测试用例

### 14.1 功能测试用例
[核心功能的测试步骤和预期结果]

### 14.2 边界测试用例
[异常情况、边界值测试]

### 14.3 兼容性测试
[浏览器兼容性、响应式测试]

## 15. 附录

### 15.1 术语表
[关键术语定义]

### 15.2 参考文档
[相关规范文档链接]

### 15.3 设计资源
[UI设计稿、原型图链接]
```

---

## 三、内容转换规则

### 3.1 从 Spec 提取信息的映射关系

| Spec 章节 | PRD 章节 | 转换规则 |
|----------|---------|---------|
| Introduction | 1.2 Product summary | 提炼业务价值，去除技术细节，强调用户收益 |
| Purpose & Scope | 2. Goals | 转换为业务目标和用户目标 |
| Definitions | 15.1 术语表 | 保留业务术语，去除纯技术术语 |
| Requirements | 4. Functional requirements | 转换为用户可见的功能描述 |
| Constraints | 8.4 Potential challenges | 转换为前端需要关注的限制 |
| Guidelines | 13. 前端实现要点 | 提取前端相关的开发建议 |
| Data Structure | 12.3 数据模型定义 | 转换为前端数据模型（VO/DTO） |
| API Design | 12. API 集成规范 | 完整复制，补充前端视角的说明 |
| Acceptance Criteria | 10. User stories | 转换为用户故事和验收标准 |

### 3.2 内容增强规则

#### 规则 1：业务价值翻译
将技术需求翻译为业务价值和用户收益
- ❌ 不好：支持分页查询接口
- ✅ 好：用户可以快速浏览和查找大量数据，提升操作效率

#### 规则 2：用户视角描述
从用户操作视角描述功能
- ❌ 不好：调用 API 保存数据到数据库
- ✅ 好：用户点击保存按钮后，系统显示保存成功提示，表单自动关闭

#### 规则 3：完整交互流程
描述从触发到结束的完整交互链路
- 触发条件 → 用户操作 → 系统反馈 → 数据变化 → UI更新

#### 规则 4：异常情况处理
必须包含所有异常场景的处理方式
- 网络错误
- 权限不足
- 数据验证失败
- 超时
- 空数据

#### 规则 5：UI 可视化
使用表格、ASCII 图、示例代码等方式直观展示
```
✅ 好的示例：
┌────────────────────┐
│ 页面标题           │
├────────────────────┤
│ [搜索区域]         │
├────────────────────┤
│ [数据表格]         │
└────────────────────┘
```

### 3.3 特殊处理规则

#### 密码字段处理
- **展示**：始终显示为 `******` 掩码
- **编辑**：空值表示不修改，有值表示更新
- **安全**：不在日志中记录，HTTPS 传输

#### 分页处理
- 默认每页条数：10/20/50 可配置
- 页码从 1 开始
- 显示总条数、当前页/总页数
- 支持跳转到指定页

#### 搜索筛选
- 输入防抖优化（300ms）
- 支持回车键触发搜索
- 清空搜索条件后自动刷新
- 筛选条件持久化（URL 参数或 Session）

#### 状态管理
- 加载中：显示 Loading 动画
- 成功：Toast 提示 + 自动关闭（2秒）
- 失败：Toast 提示 + 保持表单数据
- 二次确认：模态对话框 + 明确提示文案

---

## 四、质量检查清单

生成 PRD 文档后，请按以下清单检查：

### 4.1 完整性检查
- [ ] 包含所有必需章节（1-15）
- [ ] 每个功能都有对应的用户故事
- [ ] 所有 API 接口都有详细定义
- [ ] 数据模型完整定义
- [ ] UI/UX 设计细节完整

### 4.2 准确性检查
- [ ] 与 Spec 文档保持一致
- [ ] 没有技术细节遗漏
- [ ] 业务逻辑正确
- [ ] 数据结构匹配

### 4.3 可读性检查
- [ ] 使用非技术语言（面向前端开发者）
- [ ] 避免过度技术化表述
- [ ] 结构清晰，易于导航
- [ ] 示例丰富，易于理解

### 4.4 可执行性检查
- [ ] 每个需求都可测试
- [ ] 验收标准清晰明确
- [ ] 边界情况有明确处理
- [ ] 错误处理完整

### 4.5 前端友好性检查
- [ ] API 响应数据结构清晰
- [ ] 表单验证规则完整
- [ ] 交互流程详细
- [ ] UI 组件规范明确
- [ ] 状态管理建议合理

---

## 五、生成步骤

### Step 1: 阅读并分析 Spec 文档
1. 通读 Spec 文档，理解模块的核心目标
2. 识别所有功能需求和业务规则
3. 提取 API 接口定义和数据结构
4. 理解约束条件和边界情况

### Step 2: 创建 PRD 框架
1. 创建空白 PRD 文档，包含所有章节标题
2. 填写文档元信息（标题、版本、日期）

### Step 3: 填充核心内容
1. **Product Overview**：从 Introduction 和 Purpose 提炼，转换为产品视角
2. **Goals**：从 Requirements 提炼业务目标和用户目标
3. **User Personas**：从 Scope 的用户部分扩展
4. **Functional Requirements**：从 Requirements 转换，补充 UI 交互细节
5. **User Stories**：从 Acceptance Criteria 转换，补充完整验收标准

### Step 4: 补充前端关注内容
1. **UI/UX 详细设计**：创建页面布局图和组件规范
2. **API 集成规范**：完整复制 API 定义，补充前端视角说明
3. **前端实现要点**：提炼前端开发建议
4. **测试用例**：编写前端测试场景

### Step 5: 创作辅助内容
1. **Narrative**：创作一个完整的用户故事（500-800字）
2. **Success Metrics**：定义可衡量的成功指标
3. **Technical Considerations**：列出前端需关注的技术点

### Step 6: 质量检查与优化
1. 按质量检查清单逐项检查
2. 确保所有表格、图表格式正确
3. 确保代码示例语法正确
4. 确保链接和引用有效

---

## 六、输出示例

### 示例 1：功能需求转换

**Spec 原文：**
```
REQ-001: 支持数据库连接的 CRUD 操作 (新增、查询、编辑、删除)
```

**PRD 转换：**
```markdown
* **连接管理** (Priority: High)
  * 用户可以通过列表页面查看所有已配置的数据库连接
  * 用户可以点击"新增连接"按钮，在弹窗表单中输入连接信息并保存
  * 用户可以点击"编辑"按钮，修改已有连接的配置参数
  * 用户可以点击"删除"按钮，删除不再使用的连接（需二次确认）
  * 系统自动检查依赖关系，防止删除正在使用的连接
```

### 示例 2：API 接口转换

**Spec 原文：**
```
POST /api/dbConnection/save
请求体：{ name, type, host, port, database, username, password }
响应：{ code: 200, msg: "OK", data: true }
```

**PRD 转换：**
```markdown
#### 接口：新增数据库连接

**基本信息：**
- 路径：`POST /api/dbConnection/save`
- 说明：创建新的数据库连接配置
- 权限：需要管理员权限

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 | 示例 | 验证规则 |
|--------|------|------|------|------|----------|
| name | String | 是 | 连接名称 | "生产环境-财务库" | 2-64字符，唯一 |
| type | String | 是 | 数据库类型 | "MYSQL" | 枚举值 |
| host | String | 是 | 主机地址 | "192.168.1.100" | IP或域名 |
| port | Integer | 是 | 端口号 | 3306 | 1-65535 |
| database | String | 是 | 数据库名 | "finance_db" | 1-128字符 |
| username | String | 是 | 用户名 | "admin" | 1-64字符 |
| password | String | 是 | 密码 | "Pass@123" | 1-256字符 |

**请求示例：**
```json
{
  "name": "生产环境-财务库",
  "type": "MYSQL",
  "host": "192.168.1.100",
  "port": 3306,
  "database": "finance_db",
  "username": "admin",
  "password": "Pass@123"
}
```

**响应示例（成功）：**
```json
{
  "code": 200,
  "msg": "新增成功",
  "data": true
}
```

**响应示例（失败-名称重复）：**
```json
{
  "code": 400,
  "msg": "连接名称已存在",
  "data": false
}
```

**前端处理逻辑：**
1. 表单提交前进行客户端验证
2. 调用接口，显示 Loading 状态
3. 成功：显示成功提示，关闭表单，刷新列表
4. 失败：显示错误信息，保持表单数据，允许重试
```

### 示例 3：用户故事转换

**Spec 原文：**
```
AC-001: Given 用户在列表页面, When 点击新增按钮, Then 打开新增表单弹窗
```

**PRD 转换：**
```markdown
### 10.1. 新增数据库连接

* **ID**: DB-CONN-001
* **Description**: 作为系统管理员，我需要能够新增数据库连接配置，以便为系统添加新的数据源
* **Acceptance criteria**:
  * 点击"新增连接"按钮后，在页面中央弹出配置表单对话框
  * 表单标题显示为"新增数据库连接"
  * 表单包含以下字段：连接名称（必填）、数据库类型（必填）、主机地址（必填）、端口（必填，根据数据库类型自动填充）、数据库名（必填）、用户名（必填）、密码（必填）、描述（可选）
  * 所有必填字段标注红色星号 *
  * 数据库类型下拉框包含：MySQL、Oracle、PostgreSQL、人大金仓、达梦、南大通用
  * 选择数据库类型后，端口号自动填充默认值（MySQL:3306, Oracle:1521, PostgreSQL:5432等）
  * 表单底部包含三个按钮："测试连接"、"取消"、"保存"
  * 点击"测试连接"按钮，调用测试接口验证配置，显示测试结果（成功提示包含响应时间，失败提示包含错误原因）
  * 点击"取消"按钮，关闭表单，不保存任何数据
  * 点击"保存"按钮，进行表单验证，验证通过后调用新增接口，成功后显示"新增成功"提示并关闭表单，刷新列表
  * 如果连接名称已存在，显示错误提示"连接名称已存在"
  * 保存过程中禁用所有按钮，显示 Loading 状态
```

---

## 七、常见问题

### Q1: Spec 中的技术细节是否需要保留？
A: 保留对前端有影响的技术细节（如 API 接口、数据结构、验证规则），去除纯后端实现细节（如数据库索引、事务策略等）。

### Q2: 如何处理 Spec 中没有的 UI/UX 内容？
A: 基于功能需求合理推断界面布局和交互流程，参考同类产品的最佳实践，确保符合 HOS 框架的 UI 规范。

### Q3: 用户故事的粒度如何把控？
A: 每个用户故事应对应一个独立的用户操作流程，验收标准应详细到前端开发者可以直接实现。

### Q4: API 文档需要多详细？
A: 包含完整的请求参数（类型、必填、默认值、验证规则）、响应结构（成功和失败示例）、错误码说明。

### Q5: 如何确保 PRD 的可维护性？
A: 使用清晰的章节结构、统一的格式规范、丰富的交叉引用，便于后续更新和扩展。

---

## 八、检查与验收

生成的 PRD 文档应满足以下标准：

1. **完整性**：涵盖所有必要章节，无遗漏
2. **准确性**：与 Spec 保持一致，无错误
3. **清晰性**：结构清晰，易于理解
4. **可执行性**：前端开发者可直接依据 PRD 进行开发
5. **一致性**：术语、格式、风格统一
6. **专业性**：符合产品文档规范

---

## 附录：缩写对照表

| 缩写 | 全称 | 说明 |
|------|------|------|
| PRD | Product Requirements Document | 产品需求文档 |
| Spec | Specification | 技术规范文档 |
| API | Application Programming Interface | 应用程序接口 |
| UI | User Interface | 用户界面 |
| UX | User Experience | 用户体验 |
| CRUD | Create, Read, Update, Delete | 增删改查 |
| VO | View Object | 视图对象 |
| DTO | Data Transfer Object | 数据传输对象 |

---

**文档版本**：1.0
**创建日期**：2025-10-20
**适用范围**：hos-datafill 数据填报系统所有模块的 PRD 文档生成
