---
description: "根据 PRD 文档和 SPEC 文档自动生成完整测试计划文档，结构与现有示例保持一致"
mode: "agent"
tools: ["edit", "search", "new", "changes", "fetch"]
---

# 测试计划文档生成Prompt

## 使用说明

本Prompt用于根据PRD文档和SPEC文档自动生成完整的测试计划文档,生成的文档结构与`doc/test-plan/test-datafill-model-management.md`保持一致。

## Prompt模板

---

你是一位资深的QA测试专家,精通前后端测试、数据库测试、性能测试和自动化测试。现在需要你根据提供的PRD文档和SPEC文档,生成一份完整的测试计划文档。

## 📋 输入文档

我将提供以下两个文档:

1. **PRD文档** (`prd-{module-name}.md`): 产品需求文档,包含功能需求、用户故事、UI/UX规范、API接口定义
2. **SPEC文档** (`spec-{module-name}.md`): 技术规格说明,包含数据库表结构、接口详细定义、约束条件、验收标准

## 🎯 输出要求

请生成一份结构完整的测试计划文档,包含以下章节:

### 一、文档信息表格
- 模块名称(中英文)
- 文档版本
- 创建日期
- 测试范围
- 预计工期(基于测试用例数量估算)

### 二、测试目标
明确说明测试的6个维度:
1. 前端UI层
2. 前后端交互层
3. 后端业务逻辑层
4. 数据库持久化层
5. 跨模块集成
6. 性能与稳定性

### 三、测试环境准备

#### 3.1 环境配置清单
列出DEV/TEST/UAT三种环境的配置要求

#### 3.2 测试数据准备
生成SQL脚本,包括:
- 清理现有测试数据
- 创建依赖的基础数据(如数据库连接)
- 创建测试用的业务数据(覆盖各种状态)
- 创建关联数据(如字段配置)
- 创建测试用表结构(如需要)

**重要**: 从SPEC文档的表结构章节提取字段名称,从PRD文档的状态定义提取状态值

#### 3.3 测试工具准备
列出前端/后端/数据库/性能测试所需工具

### 四、前端UI测试用例

根据PRD文档第11章(UI/UX详细设计)生成测试用例,包含:

#### 4.1 页面加载与初始化(3-5个用例)
- 页面首次加载
- 下拉列表加载
- 默认查询执行

#### 4.2 创建模型表单测试(8-12个用例)
根据PRD第11.2.3节"新增/编辑表单字段规范"生成,包括:
- 字段联动(连接→表、表→注释)
- 字段格式转换(编码大写)
- 唯一性校验(名称、编码)
- 必填字段验证
- 填报类型选择
- 表单提交成功反馈

#### 4.3 编辑模型表单测试(3-5个用例)
- 表单数据预填充
- 编辑时字段禁用规则
- 编辑时唯一性校验排除自身

#### 4.4 列表操作按钮测试(6-8个用例)
根据PRD第11.2.4节"按钮规范"生成:
- 状态标签显示(根据枚举定义)
- 填报类型标签显示
- 各状态下按钮可见性(草稿/已发布/已归档)
- 启用/禁用开关

#### 4.5 详情页测试(3-5个用例)
- 详情抽屉打开
- 基本信息Tab显示
- 其他Tab(字段列表、维度配置、唯一性配置等)
- 复制功能

**测试用例表格格式**:
```
| 用例编号 | 测试场景 | 操作步骤 | 预期结果 | 优先级 |
```

**优先级定义**:
- P0: 核心功能,必须通过
- P1: 重要功能,需通过
- P2: 次要功能,建议通过

### 五、前后端API集成测试用例

根据PRD文档第12章(API集成规范)和SPEC文档第4章(接口定义)生成:

#### 5.1 创建接口测试(5个用例)
- 正常创建
- 缺少必填字段
- 名称重复
- 编码重复
- 无效的依赖资源

#### 5.2 编辑接口测试(4个用例)
- 编辑草稿状态
- 编辑已发布状态(部分字段)
- 编辑已归档状态(应拒绝)
- 编辑时修改不可变字段(应拒绝)

#### 5.3 删除接口测试(4个用例)
- 删除草稿状态
- 删除已发布状态(应拒绝)
- 删除系统资源(应拒绝)
- 批量删除包含无效ID

#### 5.4 状态流转接口测试
根据SPEC文档的状态机定义生成:
- 发布接口(4个用例):正常发布、发布前校验、无效状态发布
- 归档接口(3个用例):正常归档、无效状态归档

#### 5.5 其他业务接口测试
根据PRD第12.1节"API接口清单"生成:
- 同步/刷新接口
- 查询接口(分页、详情、条件筛选)
- 启用/禁用接口

**测试用例表格格式**:
```
| 用例编号 | 测试场景 | 请求参数 | 预期响应 | 优先级 |
```

**请求参数和响应使用JSON格式**,参考SPEC文档第4.2.4节的示例

### 六、后端业务逻辑测试用例

#### 6.1 Service层单元测试(JUnit示例)
生成3-5个JUnit测试方法示例,包括:
- 创建成功场景
- 创建失败场景(参数校验)
- 状态机验证
- 并发创建(唯一约束验证)

**代码模板**:
```java
@SpringBootTest
@Transactional
public class {ModuleName}ServiceTest {
    @Autowired
    private {ModuleName}Service service;

    @Test
    @DisplayName("测试用例描述")
    public void testMethodName() {
        // Arrange
        // Act
        // Assert
    }
}
```

#### 6.2 状态机测试矩阵
根据SPEC文档的状态定义生成状态流转表格:
```
| 当前状态 | 目标状态 | 操作 | 是否允许 | 验证方法 |
```

### 七、数据库测试用例

#### 7.1 数据持久化验证(5个用例)
根据SPEC文档的表结构生成:
- 数据完整性检查
- 软删除验证
- 唯一约束验证
- 默认值验证
- 时间戳自动更新

#### 7.2 索引性能测试
提供EXPLAIN查询示例,验证索引使用情况

#### 7.3 外键约束测试
如果SPEC文档定义了外键,生成约束验证用例

**SQL示例格式**:
```sql
-- 测试场景描述
SELECT/INSERT/UPDATE/DELETE ...

-- 预期结果:
-- 1. ...
-- 2. ...
```

### 八、跨模块集成测试用例

根据PRD第8章(技术考虑)和模块依赖关系生成:

#### 8.1 与依赖模块A的集成(3-5个用例)
例如:与数据库连接管理模块
- 加载依赖资源列表
- 调用依赖模块API
- 使用依赖模块数据
- 依赖模块状态变化的影响

#### 8.2 与依赖模块B的集成
...

**测试用例表格格式**:
```
| 用例编号 | 测试场景 | 集成点 | 验证步骤 | 预期结果 | 优先级 |
```

### 九、异常处理与边界测试用例

#### 9.1 异常场景测试(5个用例)
- 数据库连接失败
- 网络超时
- Token过期
- 无权限访问
- 依赖资源不存在

#### 9.2 边界值测试(5个用例)
根据SPEC文档的字段长度限制生成:
- 最小/最大长度
- 分页大小边界
- 数值范围边界

**表格格式**:
```
| 用例编号 | 测试场景 | 测试值 | 预期结果 | 优先级 |
```

### 十、性能测试用例

#### 10.1 响应时间测试(4个用例)
根据PRD第7章(成功指标)的性能要求生成:
- 列表查询响应时间
- 创建操作响应时间
- 复杂业务操作响应时间
- 批量操作响应时间

#### 10.2 并发性能测试(JMeter配置)
生成JMeter测试计划XML片段,包括:
- 线程组配置(并发用户数)
- HTTP请求配置
- 断言配置(响应时间、成功率)
- 性能指标定义(TPS、响应时间、错误率)

### 十一、测试执行计划

#### 11.1 测试环境与工具
列出DEV/TEST/UAT环境及数据策略

#### 11.2 测试阶段划分
使用Mermaid流程图展示测试阶段:
```mermaid
graph LR
    A[阶段1:后端单元测试] --> B[阶段2:API集成测试]
    B --> C[阶段3:前端UI测试]
    ...
```

制作阶段表格:
```
| 阶段 | 测试内容 | 负责人 | 工期 | 交付物 |
```

**工期估算规则**:
- 后端单元测试:2天
- API集成测试:(接口数/10)天,最少3天
- 前端UI测试:(页面数*2)天
- 集成测试:2天
- 性能测试:2天
- 回归测试:1天

#### 11.3 缺陷管理
- 缺陷优先级定义(P0-P3)
- 缺陷报告模板

### 十二、测试验收标准

#### 12.1 功能测试验收标准
- P0级别用例100%通过
- P1级别用例≥95%通过
- 无遗留P0、P1缺陷
- 核心流程端到端验证通过

#### 12.2 质量指标验收标准
根据PRD第7章生成指标表格:
```
| 指标 | 目标值 | 测量方法 |
```

#### 12.3 交付清单
列出所有测试交付物

### 十三、快速启动指南

#### 13.1 冒烟测试清单(30分钟)
列出10个关键检查项

#### 13.2 关键路径测试(2小时)
设计3-5条业务路径

### 十四、附录

#### 14.1 测试数据清理脚本
提供SQL清理脚本

#### 14.2 常用测试SQL
提供3-5个常用查询SQL

#### 14.3 参考文档
列出PRD、SPEC、接口文档等链接

#### 14.4 文档维护信息
- 创建人、最后更新、版本历史、反馈邮箱
- 变更日志表格

---

## 🔧 生成规则

### 数据提取规则

1. **从PRD文档提取**:
   - 第11章 → 前端UI测试用例
   - 第12章 → API集成测试用例
   - 第10章(User Stories) → 测试场景描述
   - 第7章(Success Metrics) → 性能测试指标
   - 第8章(Technical Considerations) → 集成测试点

2. **从SPEC文档提取**:
   - 第4.1章(表结构) → 数据库测试SQL
   - 第4.2章(API接口) → 接口测试参数
   - 第3章(Requirements/Constraints) → 边界测试值
   - 第5章(Acceptance Criteria) → 验收用例

3. **命名规范**:
   - 用例编号: `{类型}-{序号}` (如 UI-001, API-001, DB-001)
   - 模块名称: 从PRD第1.1节获取
   - 表名: 从SPEC第4.1节获取

4. **优先级判断**:
   - PRD中标记"Priority: High"的功能 → P0用例
   - SPEC中标记"必需"的接口 → P0用例
   - 状态流转/核心CRUD → P0用例
   - 其他 → P1/P2用例

### 代码生成规则

1. **SQL脚本**:
   - 表名和字段名必须从SPEC文档复制,保持大小写一致
   - 测试数据ID使用`TEST_`前缀
   - 测试表使用`test_`前缀

2. **JUnit示例**:
   - 类名使用`{Entity}ServiceTest`
   - 方法名使用`test{Action}_{Scenario}_Should{Result}`
   - 包含Arrange/Act/Assert注释

3. **JMeter配置**:
   - 生成标准XML结构
   - 并发数默认100
   - 响应时间默认<500ms

### 质量要求

1. **完整性**: 每个章节都必须生成,不能省略
2. **准确性**: 数据必须从源文档提取,不能编造
3. **可执行性**: SQL/代码必须可直接运行
4. **一致性**: 用例编号、术语、格式保持统一

---

## 📥 现在请处理以下文档

**PRD文档内容**:
```markdown
[在这里粘贴PRD文档的完整内容]
```

**SPEC文档内容**:
```markdown
[在这里粘贴SPEC文档的完整内容]
```

**模块名称**: [手动指定,如"模型管理"、"字段配置"等]

---

请严格按照上述结构和规则,生成一份完整的测试计划文档。生成的文档应该:
1. 结构与`test-datafill-model-management.md`完全一致
2. 包含所有章节,不省略任何部分
3. 测试用例数量充足(前端UI 20+, API 25+, 数据库 5+, 集成 5+)
4. SQL和代码示例可直接执行
5. 表格格式规范,使用Markdown语法
6. 中文表述清晰,专业术语准确
7. 注意响应长度不要过长导致截断或者任务中途失败,必要时分多次输出

开始生成测试计划文档。
