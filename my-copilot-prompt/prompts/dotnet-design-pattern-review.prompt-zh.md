---
代理人：“代理人”
描述：“查看设计模式实现的 C#/.NET 代码并提出改进建议。”
---
# .NET/C# 设计模式回顾

查看 ${selection} 中的 C#/.NET 代码以实现设计模式，并提出解决方案/项目的改进建议。不要对代码进行任何更改，只需进行审查。

## 所需的设计模式

- **命令模式**：通用基类（`CommandHandler<TOptions>`）、`ICommandHandler<TOptions>` 接口、`CommandHandlerOptions` 继承、静态 `SetupCommand(IHost host)` 方法
- **工厂模式**：复杂对象创建服务提供者集成
- **依赖注入**：主构造函数语法、`ArgumentNullException` null 检查、接口抽象、正确的服务生命周期
- **存储库模式**：连接的异步数据访问接口提供者抽象
- **提供者模式**：外部服务抽象（数据库、人工智能）、清晰的契约、配置处理
- **资源模式**：用于本地化消息的 ResourceManager，单独的 .resx 文件（LogMessages、ErrorMessages）

## 审查清单

- **设计模式**：识别所使用的模式。命令处理程序、工厂、提供者和存储库模式是否正确实现？缺少有益的模式？
- **架构**：遵循命名空间约定（`{Core|Console|App|Service}.{Feature}`）？核心/控制台项目之间是否正确分离？模块化且可读？
- **.NET 最佳实践**：主构造函数、异步/等待任务返回、ResourceManager 使用、结构化日志记录、强类型配置？
- **GoF 模式**：命令、工厂、模板方法、策略模式是否正确实施？
- **坚实的原则**：单一职责、开放/封闭、里氏替换、接口隔离、依赖倒置违规？
- **性能**：适当的异步/等待、资源处置、ConfigureAwait(false)、并行处理机会？
- **可维护性**：清晰的关注点分离、一致的错误处理、正确的配置使用？
- **可测试性**：通过接口抽象的依赖关系、可模拟组件、异步可测试性、AAA 模式兼容性？
- **安全性**：输入验证、安全凭证处理、参数化查询、安全异常处理？
- **文档**：公共 API 的 XML 文档、参数/返回描述、资源文件组织？
- **代码清晰度**：反映领域概念的有意义的名称、通过模式明确的意图、不言自明的结构？
- **干净的代码**：一致的风格、适当的方法/类大小、最小的复杂性、消除重复？

## 改进重点领域

- **命令处理程序**：基类中的验证、一致的错误处理、适当的资源管理
- **工厂**：依赖配置、服务提供商集成、处置模式
- **提供程序**：连接管理、异步模式、异常处理和日志记录
- **配置**：数据注释、验证属性、安全敏感值处理
- **AI/ML 集成**：语义内核模式、结构化输出处理、模型配置

提供与项目架构和 .NET 最佳实践相一致的具体、可操作的改进建议。
