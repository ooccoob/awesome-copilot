---
agent: 'agent'
description: 'Prompt for creating the high-level technical architecture for an Epic, based on a Product Requirements Document.'
---

# 史诗架构规范提示

## 目标

担任高级软件架构师。您的任务是获取 Epic PRD 并创建高级技术架构规范。本文档将指导史诗的开发，概述所需的主要组件、功能和技术推动因素。

## 上下文考虑因素

- 来自产品经理的 Epic PRD。
- **领域驱动架构** 用于模块化、可扩展应用程序的模式。
- **自托管和 SaaS 部署**要求。
- **所有服务的 Docker 容器化**。
- **TypeScript/Next.js** 与 App Router 堆栈。
- **Turborepo monorepo** 模式。
- **tRPC** 用于类型安全的 API。
- **堆栈验证**用于身份验证。

**注意：** 不要在输出中编写代码，除非它是用于技术情况的伪代码。

## 输出格式

输出应该是 Markdown 格式的完整 Epic 架构规范，保存到 `/docs/ways-of-work/plan/{epic-name}/arch.md`。

### 规格结构

#### 1. 史诗架构概述

- 史诗技术方法的简要总结。

#### 2. 系统架构图

创建一个全面的美人鱼图来说明这部史诗的完整系统架构。该图应包括：

- **用户层**：显示不同的用户类型（网络浏览器、移动应用程序、管理界面）如何与系统交互
- **应用层**：描述负载均衡器、应用程序实例和身份验证服务（Stack Auth）
- **服务层**：包括 tRPC API、后台服务、工作流引擎 (n8n) 和任何特定于史诗的服务
- **数据层**：显示数据库 (PostgreSQL)、矢量数据库 (Qdrant)、缓存层 (Redis) 和外部 API 集成
- **基础设施层**：代表Docker容器化和部署架构

使用清晰的子图来组织这些层，为不同的组件类型应用一致的颜色编码，并显示组件之间的数据流。包括与史诗相关的同步请求路径和异步处理流程。

#### 3.高级功能和技术推动因素

- 要构建的高级功能的列表。
- 支持这些功能所需的技术推动因素（例如新服务、库、基础设施）列表。

#### 4. 技术栈

- 要使用的关键技术、框架和库的列表。

#### 5、技术价值

- 估计技术价值（例如，高、中、低）并附上简短的理由。

#### 6. T 恤尺寸估算

- 提供史诗 T 恤尺寸的高级估计（例如 S、M、L、XL）。

## 上下文模板

- **Epic PRD：** [Epic PRD markdown 文件的内容]
