# é¢„æ£€æŠ¥å‘Šæ¨¡æ¿

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ç”Ÿæˆ `preflight-report.md` æ—¶ä½¿ç”¨æ­¤æ¨¡æ¿ç»“æ„ã€‚

---

## æ¨¡æ¿

```markdown
# Azure Deployment Preflight Report

**Generated:** {timestamp}
**Status:** {overall-status}

---

## Summary

| Property | Value |
|----------|-------|
| **Template File(s)** | {bicep-files} |
| **Parameter File(s)** | {param-files-or-none} |
| **Project Type** | {azd-project | standalone-bicep} |
| **Deployment Scope** | {resourceGroup | subscription | managementGroup | tenant} |
| **Target** | {resource-group-name | subscription-name | mg-id} |
| **Validation Level** | {Provider | ProviderNoRbac} |

### Validation Results

| Check | Status | Details |
|-------|--------|---------|
| Bicep Syntax | {âœ… Pass | âŒ Fail | âš ï¸ Warnings | â­ï¸ Skipped} | {details} |
| What-If Analysis | {âœ… Pass | âŒ Fail | â­ï¸ Skipped} | {details} |
| Permission Check | {âœ… Pass | âš ï¸ Limited | âŒ Fail} | {details} |

---

## Tools Executed

### Commands Run

| Step | Command | Exit Code | Duration |
|------|---------|-----------|----------|
| 1 | `{command}` | {0 | non-zero} | {duration} |
| 2 | `{command}` | {0 | non-zero} | {duration} |

### Tool Versions

| Tool | Version |
|------|---------|
| Azure CLI | {version} |
| Bicep CLI | {version} |
| Azure Developer CLI | {version-or-n/a} |

---

## Issues

{if-no-issues}
âœ… **No issues found.** The deployment is ready to proceed.
{end-if}

{if-issues-exist}
### Errors

{for-each-error}
#### âŒ {error-title}

- **Severity:** Error
- **Source:** {bicep-build | what-if | permissions}
- **Location:** {file-path}:{line}:{column} (if applicable)
- **Message:** {error-message}
- **Remediation:** {suggested-fix}
- **Documentation:** {link-if-available}

{end-for-each}

### Warnings

{for-each-warning}
#### âš ï¸ {warning-title}

- **Severity:** Warning
- **Source:** {source}
- **Message:** {warning-message}
- **Recommendation:** {suggested-action}

{end-for-each}
{end-if}

---

## What-If Results

{if-what-if-succeeded}

### Change Summary

| Change Type | Count |
|-------------|-------|
| ğŸ†• Create | {count} |
| ğŸ“ Modify | {count} |
| ğŸ—‘ï¸ Delete | {count} |
| âœ“ No Change | {count} |
| âš ï¸ Ignore | {count} |

### Resources to Create

{if-resources-to-create}
| Resource Type | Resource Name |
|---------------|---------------|
| {type} | {name} |
{end-if}

{if-no-resources-to-create}
*No resources will be created.*
{end-if}

### Resources to Modify

{if-resources-to-modify}
#### {resource-type}/{resource-name}

| Property | Current Value | New Value |
|----------|---------------|-----------|
| {property-path} | {current} | {new} |

{end-if}

{if-no-resources-to-modify}
*No resources will be modified.*
{end-if}

### Resources to Delete

{if-resources-to-delete}
| Resource Type | Resource Name |
|---------------|---------------|
| {type} | {name} |

> âš ï¸ **Warning:** Resources listed for deletion will be permanently removed.
{end-if}

{if-no-resources-to-delete}
*No resources will be deleted.*
{end-if}

{end-if-what-if-succeeded}

{if-what-if-failed}
### What-If Analysis Failed

The what-if operation could not complete. See the Issues section for details.
{end-if}

---

## Recommendations

{generate-based-on-findings}

1. {recommendation-1}
2. {recommendation-2}
3. {recommendation-3}

---

## Next Steps

{if-all-passed}
The preflight validation passed. You can proceed with deployment:

**For azd projects:**
```bash
azdè§„å®š
# æˆ–
azd å‘ä¸Š
```

**For standalone Bicep:**
```bash
az éƒ¨ç½²ç»„åˆ›å»º \
  --resource-group {rg-name} \
  --æ¨¡æ¿æ–‡ä»¶ {äºŒå¤´è‚Œæ–‡ä»¶} \
  --parameters {å‚æ•°æ–‡ä»¶}
```
{end-if}

{if-issues-exist}
Please resolve the issues listed above before deploying. After fixes:

1. Re-run preflight validation to verify fixes
2. Proceed with deployment once all checks pass
{end-if}

---

*Report generated by Azure Deployment Preflight Skill*
```

---

## çŠ¶æ€å€¼

### æ•´ä½“çŠ¶å†µ

|çŠ¶æ€ |æ„ä¹‰|è§†è§‰ |
|--------|---------|--------|
| **é€šè¿‡** |æ‰€æœ‰æ£€æŸ¥å‡æˆåŠŸï¼Œå¯ä»¥å®‰å…¨éƒ¨ç½² | âœ… |
| **é€šè¿‡ä½†æœ‰è­¦å‘Š** |æ£€æŸ¥æˆåŠŸä½†æŸ¥çœ‹è­¦å‘Š | âš ï¸ |
| **å¤±è´¥** |ä¸€é¡¹æˆ–å¤šé¡¹æ£€æŸ¥å¤±è´¥ | âŒ |

### ä¸ªäººæ”¯ç¥¨çŠ¶æ€

|çŠ¶æ€ |æ„ä¹‰|
|--------|---------|
| âœ… é€šè¿‡ |æ£€æŸ¥æˆåŠŸå®Œæˆ |
| âŒ å¤±è´¥ |æ£€æŸ¥å‘ç°é”™è¯¯ |
| âš ï¸è­¦å‘Š|æ£€æŸ¥é€šè¿‡ä½†æœ‰è­¦å‘Š |
| â­ï¸ è·³è¿‡ |æ£€æŸ¥è¢«è·³è¿‡ï¼ˆå·¥å…·ä¸å¯ç”¨ç­‰ï¼‰|

---

## æŠ¥å‘Šç¤ºä¾‹

```markdown
# Azure Deployment Preflight Report

**Generated:** 2026-01-16T14:32:00Z
**Status:** âš ï¸ Pass with Warnings

---

## Summary

| Property | Value |
|----------|-------|
| **Template File(s)** | `infra/main.bicep` |
| **Parameter File(s)** | `infra/main.bicepparam` |
| **Project Type** | azd project |
| **Deployment Scope** | subscription |
| **Target** | my-subscription |
| **Validation Level** | Provider |

### Validation Results

| Check | Status | Details |
|-------|--------|---------|
| Bicep Syntax | âœ… Pass | No errors found |
| What-If Analysis | âš ï¸ Warnings | 1 resource ignored due to nested template limits |
| Permission Check | âœ… Pass | Full deployment permissions verified |

---

## Tools Executed

### Commands Run

| Step | Command | Exit Code | Duration |
|------|---------|-----------|----------|
| 1 | `bicep build infra/main.bicep --stdout` | 0 | 1.2s |
| 2 | `azd provision --preview --environment dev` | 0 | 8.4s |

### Tool Versions

| Tool | Version |
|------|---------|
| Azure CLI | 2.76.0 |
| Bicep CLI | 0.25.3 |
| Azure Developer CLI | 1.9.0 |

---

## Issues

### Warnings

#### âš ï¸ Nested Template Limit Reached

- **Severity:** Warning
- **Source:** what-if
- **Message:** 1 resource was ignored because nested template expansion limits were reached
- **Recommendation:** Review the ignored resource manually after deployment

---

## What-If Results

### Change Summary

| Change Type | Count |
|-------------|-------|
| ğŸ†• Create | 3 |
| ğŸ“ Modify | 1 |
| ğŸ—‘ï¸ Delete | 0 |
| âœ“ No Change | 2 |
| âš ï¸ Ignore | 1 |

### Resources to Create

| Resource Type | Resource Name |
|---------------|---------------|
| Microsoft.Resources/resourceGroups | rg-myapp-dev |
| Microsoft.Storage/storageAccounts | stmyappdev |
| Microsoft.Web/sites | app-myapp-dev |

### Resources to Modify

#### Microsoft.KeyVault/vaults/kv-myapp-dev

| Property | Current Value | New Value |
|----------|---------------|-----------|
| properties.sku.name | standard | premium |
| tags.environment | staging | dev |

### Resources to Delete

*No resources will be deleted.*

---

## Recommendations

1. Review the storage account name `stmyappdev` to ensure it meets naming requirements
2. Confirm the Key Vault SKU upgrade from standard to premium is intentional
3. The ignored nested template resource should be verified after deployment

---

## Next Steps

The preflight validation passed with warnings. Review the warnings above, then proceed:

```bash
azd æä¾›--ç¯å¢ƒå¼€å‘
```

---

*Report generated by Azure Deployment Preflight Skill*
```

---

## æ ¼å¼æŒ‡å—

1. **ä½¿ç”¨ä¸€è‡´çš„è¡¨æƒ…ç¬¦å·**è¿›è¡Œè§†è§‰æ‰«æ
2. **å¼•ç”¨äºŒå¤´è‚Œé”™è¯¯æ—¶åŒ…æ‹¬è¡Œå·**
3. **ä¸ºæ¯ä¸ªé—®é¢˜æä¾›å¯è¡Œçš„è¡¥æ•‘æªæ–½**
4. **æ–‡æ¡£é“¾æ¥**ï¼ˆå¦‚æœå¯ç”¨ï¼‰
5. **æŒ‰ä¸¥é‡æ€§å¯¹é—®é¢˜è¿›è¡Œæ’åº**ï¼ˆé¦–å…ˆæ˜¯é”™è¯¯ï¼Œç„¶åæ˜¯è­¦å‘Šï¼‰
6. **åœ¨åç»­æ­¥éª¤ä¸­åŒ…å«å‘½ä»¤ç¤ºä¾‹**
