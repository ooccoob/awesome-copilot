---
名称：workiq-copilot
描述：“指导 Copilot CLI 如何使用 WorkIQ CLI/MCP 服务器查询 Microsoft 365 Copilot 数据（电子邮件、会议、文档、团队、人员）以获取实时上下文、摘要和建议。”
---

# WorkIQ 副驾驶技能

## 概述

WorkIQ（公共预览版）允许 Copilot 使用自然语言查询 Microsoft 365 数据。它支持计划、文档、Teams 消息、电子邮件线程、后续跟踪、利益相关者摘要等。每当任务需要本地存储库之外的实时组织情报时，请使用此技能。

## 支持的数据和示例提示

- **电子邮件** – “总结莎拉关于预算的电子邮件。”
- **会议** – “本周即将举行的会议有哪些？”
- **文件** – “查找有关第四季度规划的最新文件。”
- **团队** – “总结今天工程频道中的消息。”
- **人员/项目** – “谁在参与 Alpha 项目？”

## 获取访问权限

1. **Copilot CLI 插件（首选）**
   - __代码0__
   - __代码0__
   - __代码0__
   - 重新启动 Copilot CLI。
2. **独立 CLI/MCP 服务器**
   - `npm install -g @microsoft/workiq`（或 `npx -y @microsoft/workiq mcp`）。
   - 如果需要，运行 `workiq mcp` 以公开 MCP 工具。
3. **租户同意**
   - 首先使用提示获得 Microsoft 365 管理员同意（EULA + 权限）。非管理员必须根据租户管理员启用指南联系租户管理员进行批准。

## 飞行前检查表

- 运行 `Get-Command workiq` 以确保二进制文件可用。
- 通过 `workiq accept-eula` 接受一次 EULA。
- 确认正确的租户（如果与默认 `common` 不同，则为 `-t <tenant-id>`）。
- 出现提示时，准备好在浏览器中完成设备登录。

## 核心工作流程

1. **澄清意图** – 议程、行动项目、文档查找、人员搜索、风险总结等。
2. **制作精确的提示** – 包括时间范围、来源或主题（例如，“总结今天 #eng 中的团队帖子”）。
3. **运行命令** – `workiq ask --question "<prompt>"`（如果需要，可使用 `-q` 进行简写）。
4. **监控执行情况** – 可能会出现长答案；在发出其他请求之前等待响应完成。
5. **总结和编辑** – 突出见解，注意冲突/任务，除非需要，否则避免粘贴原始链接。
6. **提供后续行动** – 阻塞时间、起草笔记、更深入的查询等。

## 命令参考

|命令|目的|
| --------------------------------- | ------------------------------------------------------------- |
| __代码0__ |显示全局选项。                                          |
| __代码0__ |显示已安装的版本。                                    |
| __代码0__ |接受许可证（首次使用）。                                   |
| __代码0__ |交互模式。                                             |
| __代码0__ |提出一个具体问题（如果愿意，可以使用 `-q` 速记）。    |
| __代码0__ |针对特定租户。                                     |
| __代码0__ |启动 MCP stdio 服务器（向其他代理公开 WorkIQ 工具）。 |

## 提示模式

- 议程：“明天我的日历上有什么？”
- 行动项目：“总结今天客户同步的后续行动。”
- 文档：“列出有关 Contoso 2026 财年路线图的 PowerPoint。”
- 沟通：“我的经理对截止日期说了些什么？”
- 见解：“过去三场会议中出现了哪些阻碍因素？”
- 计划：“建议周二下午的重点区域。”

## 应对指南

- 保持摘要简洁（2-3 句话），指出负载、优先级、阻碍因素和可选的后续步骤。
- 除非用户特别需要链接，否则请泛指会议/文档。
- 提及 WorkIQ 是否可以继续（例如，“如果需要，WorkIQ 可以显示周四至周日”）。
- 映射 WorkIQ 的建议操作以清除报价（阻止时间、发送后续信息、请求记录、运行更深入的查询）。

## 最佳实践

- 喜欢狭窄的提示以减少噪音；如果需要，运行多个查询。
- 在做出回应之前，逻辑地组合输出（议程+冲突+行动项目）。
- 尊重隐私：除非明确要求，否则不要公开与会者名单或机密片段。
- 记录运行的命令，以便将来的步骤可以引用它们（“向 WorkIQ 询问议程 + 冲突”）。
- 当另一个代理/工作流需要直接工具访问时，请使用 MCP 模式 (`workiq mcp`)。

## 故障排除

- **缺少 CLI** – 通过 npm 安装或确保设置 PATH；如果不可用则通知用户。
- **同意/身份验证错误** – 在管理员授予权限后或完成设备登录后重新运行命令。
- **长/不完整的输出** – 以细化的范围重新运行或要求特定的数据切片（每天/项目/人）。
- **命令挂起** – 取消终端中正在运行的命令（例如，使用 Ctrl+C）或重新启动 Copilot CLI 会话，然后重试；确保浏览器登录完成。

## 提供的后续行动

- 块焦点/溢出在建议的时间保持。
- 参考 WorkIQ 指南起草重新安排/拒绝消息。
- 请求重叠会话的录音或摘要。
- 将行动项目捕获到任务跟踪器中。
- 运行其他 WorkIQ 查询（按项目、利益相关者、时间范围）以进行更深入的分析。
